<div class="save-form-lms">
  <form nz-form [formGroup]="form" style="margin-top: 20px">
    <div nz-row [nzGutter]="[30, 30]">
      <!--trường đào tạo-->
      <div nz-col [nzXs]="12" [nzLg]="12">
        <hbt-select
          [serviceName]="microService.ADMIN"
          [urlLoadData]="getUrlCategory(categoryCode.LMS_INTERN_TRUONG_DAO_TAO)"
          keyLabel="name"
          formControlName="universityId"
          [type]="isSubmitted && form.controls['universityId']?.errors ? 'error' : 'default'"
          [showError]="isSubmitted && form.controls['universityId']?.errors != null"
          [errors]="form.controls['universityId']?.errors"
          [errorDefs]="[
            {
              errorName: 'required',
              errorDescription:
                'common.validate.required'
                | translate : { param: 'lms.internshipSessions.label.universityId' | translate }
            }
          ]"
          placeholder="{{ 'lms.internshipSessions.label.universityId' | translate }}"
          labelText="{{ 'lms.internshipSessions.label.universityId' | translate }} <span class='label__required'>*</span>"
        ></hbt-select>
      </div>

      <!--Khóa thực tập-->
      <div nz-col [nzXs]="12" [nzLg]="12">
        <hbt-input-text
          formControlName="sessionName"
          maxLength="255"
          [type]="isSubmitted && form.controls['sessionName']?.errors ? 'error' : 'default'"
          [showError]="isSubmitted && form.controls['sessionName']?.errors != null"
          [errors]="form.controls['sessionName']?.errors"
          [errorDefs]="[
            {
              errorName: 'maxlength',
              errorDescription: 'common.validate.maxLength' | translate : { numberLength: 255 }
            },
            {
              errorName: 'required',
              errorDescription:
                'common.validate.required' | translate : { param: 'lms.internshipSessions.table.sessionName' | translate }
            }
          ]"
          placeholderText="{{ 'lms.internshipSessions.table.sessionName' | translate }}"
          labelText="{{ 'lms.internshipSessions.table.sessionName' | translate }} <span class='label__required'>*</span>"
        ></hbt-input-text>
      </div>

      <!--Từ ngày-->
      <div nz-col [nzXs]="12" [nzLg]="12">
        <hbt-date-picker
          placeholderText="{{ 'lms.internshipSessions.table.startDate' | translate }}"
          labelText="{{ 'lms.internshipSessions.table.startDate' | translate }} <span class='label__required'>*</span>"
          [type]="isSubmitted && (form?.errors || form.controls['startDate']?.errors) ? 'error' : 'default'"
          [showError]="isSubmitted && (form?.errors || form.controls['startDate']?.errors) != null"
          [errors]="form?.errors?.rangeDateError ? form?.errors : form.controls['startDate']?.errors"
          [errorDefs]="[
            {
              errorName: 'rangeDateError',
              errorDescription:
                'common.validate.rangeDate.pareDate'
                | translate
                  : {
                      fromDate: 'lms.internshipSessions.table.startDate' | translate,
                      toDate: 'lms.internshipSessions.table.endDate' | translate
                    }
            },
            {
              errorName: 'required',
              errorDescription:
                'common.validate.required' | translate : { param: 'lms.internshipSessions.table.startDate' | translate }
            }
          ]"
          formControlName="startDate"
        ></hbt-date-picker>
      </div>

      <!--Đến ngày-->
      <div nz-col [nzXs]="12" [nzLg]="12">
        <hbt-date-picker
          placeholderText="{{ 'lms.internshipSessions.table.endDate' | translate }}"
          labelText="{{ 'lms.internshipSessions.table.endDate' | translate }} <span class='label__required'>*</span>"
          formControlName="endDate"
          [type]="isSubmitted && form.controls['endDate']?.errors ? 'error' : 'default'"
          [showError]="isSubmitted && form.controls['endDate']?.errors != null"
          [errors]="form.controls['endDate']?.errors"
          [errorDefs]="[
             {
              errorName: 'required',
              errorDescription:
                'common.validate.required' | translate : { param: 'lms.internshipSessions.table.endDate' | translate }
            }
          ]"


        ></hbt-date-picker>
      </div>

      <!--Số lượng thực tập-->
      <div nz-col [nzXs]="24" [nzLg]="24">
        <ng-container formArrayName="details" >
          <ng-container *ngFor="let item of org.controls;let idx = index" >
           <div nz-row [nzGutter]="[20,15]" [formGroupName]="idx">
            <div nz-col [nzXs]="24" [nzLg]="12">
              <tree-data-picker
              [isExpand]="true"
              labelText="{{'lms.internshipSessions.label.orgId' | translate}} <span class='label__required'>*</span>"
              placeholder="{{'lms.internshipSessions.label.orgId' | translate}}"
              formControlName='organizationId'
              [type]="isSubmitted && item.get('organizationId')?.errors ? 'error' : 'default'"
              [showError]="isSubmitted && item.get('organizationId')?.errors != null"
              [errors]="item.get('organizationId')?.errors"
              [errorDefs]="[
                 {
                  errorName: 'required',
                  errorDescription:
                    'common.validate.required' | translate : { param: 'lms.internshipSessions.label.orgId' | translate }
                }
              ]"

            >
            </tree-data-picker>

            </div>
            <div nz-col [nzXs]="24" [nzLg]="6">
              <hbt-select
              formControlName="majorId"
              [serviceName]="microService.ADMIN"
              [urlLoadData]="getUrlCategory(categoryCode.LMS_INTERN_CHUYEN_NGANH)"
              keyLabel="name"
              [type]="isSubmitted && item.get('majorId')?.errors ? 'error' : 'default'"
              [showError]="isSubmitted && item.get('majorId')?.errors != null"
              [errors]="item.get('majorId')?.errors"
              [errorDefs]="[
                { errorName: 'required', errorDescription: 'common.validate.required' | translate: {'param': 'lms.internshipSessions.label.majorId' | translate }},
                   { errorName: 'duplicate', errorDescription: 'common.validate.duplicate' | translate: {'param': 'lms.internshipSessions.validate.duplicateMajor' | translate }}
              ]"
              placeholder="{{'lms.internshipSessions.label.majorId' | translate}}"
              labelText="{{'lms.internshipSessions.label.majorId' | translate}} <span class='label__required'>*</span>"

              >

              </hbt-select>
            </div>
            <div nz-col [nzXs]="24" [nzLg]="3">
              <hbt-input-text
              formControlName="numOfStudents"
              appNumberInput
              [type]="isSubmitted &&  item.get('numOfStudents')?.errors ? 'error' : 'default'"
              [showError]="isSubmitted &&  item.get('numOfStudents')?.errors != null"
              [errors]=" item.get('numOfStudents')?.errors"
              [errorDefs]="[{ errorName: 'required', errorDescription: 'common.validate.required' | translate: {'param': 'lms.internshipSessions.label.totalStudents' | translate }},
              { errorName: 'maxlength', errorDescription: 'common.validate.maxLength' | translate: {'numberLength': 255}}]"
              placeholderText="{{'lms.internshipSessions.label.totalStudents' | translate}}"
              labelText="{{'lms.internshipSessions.label.totalStudents' | translate}} <span class='label__required'>*</span>"

              >

              </hbt-input-text>
            </div>
            <div nz-col [nzXs]="24" [nzLg]="3">
              <div *ngIf="mode !== modeConst.VIEW && mode !== modeConst.EDIT" nz-col [nzXs]="24" [nzLg]="4" class="area-action-partici">
                <em nz-button nz-icon nzType="plus-circle" nzTheme="outline"
                    nz-tooltip
                    nzTooltipTitle="{{'common.button.add' | translate}}"
                    nzTooltipPlacement="left"
                    class="btn-create"
                    (click)="addOrg()"></em>
                <em nz-button nz-icon nzType="delete" nzTheme="outline"
                    nz-tooltip
                    nzTooltipTitle="{{'common.button.delete' | translate}}"
                    nzTooltipPlacement="right"
                    class="btn-removed"
                    (click)="removeOrg(idx)"></em>
              </div>
            </div>

           </div>
          </ng-container>
        </ng-container>
      </div>

      <ng-container formArrayName="listAttributes">
        <ng-container *ngFor="let attributes of attributesFormArray.controls; let idx = index" [formGroupName]="idx">
          <div nz-col [nzXs]="12" [nzLg]="12">
            <input-attribute-common
              [controlName]="getAttributeControl(idx, 'attributeValue')"
              [dataType]="attributes.get('dataType')?.value"
              [urlLoadData]="attributes.get('urlLoadData')?.value"
              [type]="isSubmitted && attributes.get('attributeValue')?.errors ? 'error' : 'default'"
              [showError]="isSubmitted && attributes.get('attributeValue')?.errors != null"
              [errors]="attributes.get('attributeValue')?.errors"
              [errorDefs]="[{ errorName: 'required', errorDescription: 'common.validate.required' | translate: {'param': attributes.get('attributeName')?.value | translate }}]"
              [placeholderText]="attributes.get('attributeName')?.value"
              [labelText]="getLabelText(attributes.get('attributeName')?.value, attributes.get('isRequired')?.value)"
            >
            </input-attribute-common>
          </div>
        </ng-container>
      </ng-container>

      <div nz-col [nzXs]="24" [nzLg]="24" class="input__group">
        <hbt-upload
          [(docIdsDelete)]="docIdsDelete"
          [typeFileAvailable]="['jpg', 'png', 'pdf', 'doc', 'docx']"
          [multiple]="true"
          labelText="{{ 'common.label.attachFile' | translate }}"
          (fileListChange)="onFileListChange($event, 'fileList', true)"
          (docIdsDeleteChange)="removeFile($event, 'fileList')"
          [serviceName]="serviceName"
          [showError]="isSubmitted"
        ></hbt-upload>
      </div>

    </div>

  </form>
</div>
