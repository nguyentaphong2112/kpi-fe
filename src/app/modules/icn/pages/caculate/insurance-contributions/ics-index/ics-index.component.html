<form nz-form [formGroup]="form" class="ics-index">
  <div class="search__custom-common {{isShowAdvSearch ? 'add__mr__bt-10' : 'remove__mr__bt-40'}}">
    <div nz-row class="button__action-left">
      <hbt-button
        class="staff__research__btn__search"
        buttonSize="LARGE"
        style="margin-right: 20px"
        buttonAvailableStyle="SAVE"
        buttonText="{{'icn.icnContribution.calculate.action.makeList' | translate}}"
        *ngIf="objFunction?.create"
        (click)="onMakeList()"
      ></hbt-button>
      <btn-more-action [setting]="actionSchemaHeader" [isBtn]="true">
      </btn-more-action>
    </div>

    <div class="search__page-right">
      <hbt-input-text formControlName='keySearch'
                      [maxLength]='255'
                      placeholderText="{{'icn.icnContribution.calculate.search.keySearch' | translate}}"></hbt-input-text>
      <hbt-button
        buttonIconType="AWESOME"
        [prefixIcon]="isShowAdvSearch ? 'fa fa-angle-double-up' : 'fa fa-angle-double-down'"
        buttonSize="VERY_LARGE"
        [buttonTextColor]="_variable.$neutral_100"
        [buttonBorderColor]="_variable.$purple_800"
        [buttonBgColor]="_variable.$purple_800"
        (click)="isShowAdvSearch = !isShowAdvSearch"
      >
      </hbt-button>
    </div>
  </div>
  <div *ngIf="isShowAdvSearch" class="content__item content__item--border bg__content--default">
    <div class="form-search">
      <div nz-row [nzGutter]='[20,15]'>
        <div nz-col [nzXs]="24" [nzLg]="8">
          <tree-data-picker
            [isExpand]="true"
            formControlName="orgId"
            [scope]="scope"
            [functionCode]="functionCode"
            labelText="{{'icn.icnContribution.calculate.search.unitName' | translate}}"
            placeholder="{{'icn.icnContribution.calculate.search.unitName' | translate}}"
          >
          </tree-data-picker>
        </div>
        <div nz-col [nzXs]='24' [nzLg]='8'>
          <hbt-date-picker
            mode="month"
            formControlName="periodDate"
            labelText="{{ 'icn.icnContribution.calculate.search.periodDate' | translate }} <span class='label__required'>*</span>"
            placeholderText="{{ 'icn.icnContribution.calculate.search.periodDate' | translate }}"
            [type]="isSubmitted && form.controls['periodDate'].errors ? 'error' : 'default'"
            [showError]="isSubmitted && form.controls['periodDate'].errors != null"
            [errors]="form.controls['periodDate'].errors"
            [errorDefs]="[{ errorName: 'required', errorDescription: 'common.validate.required' | translate: {'param': 'icn.icnContribution.calculate.search.periodDate' | translate }}]"
          ></hbt-date-picker>
        </div>
        <div nz-col [nzXs]="24" [nzLg]="8">
          <hbt-select-check-able
            formControlName="listEmpTypeCode"
            [urlLoadData]="urlLoadEmpTypeList"
            [serviceName]="MICRO_SERVICE.HRM"
            keyLabel="name"
            keyValue="code"
            placeholder="{{'icn.icnContribution.calculate.search.empTypeCode' | translate}}"
            labelText="{{'icn.icnContribution.calculate.search.empTypeCode' | translate}}"
          >
          </hbt-select-check-able>
        </div>
        <div nz-col [nzXs]="12" [nzLg]="8">
          <hbt-select-check-able [urlLoadData]="getUrlCategory(categoryCode.ICN_LOAI_DS_TRICH_NOP)"
                                 [serviceName]="microService.ADMIN"
                                 keyLabel="name"
                                 keyValue="code"
                                 formControlName="listType"
                                 placeholder="{{'icn.icnContribution.calculate.search.type' | translate}}"
                                 labelText="{{'icn.icnContribution.calculate.search.type' | translate}}"
          ></hbt-select-check-able>
        </div>
        <div nz-col [nzXs]="12" [nzLg]="8">
          <hbt-select-check-able [urlLoadData]="getUrlCategory(categoryCode.ICN_TRANG_THAI_THU_BHXH)"
                                 [serviceName]="microService.ADMIN"
                                 keyLabel="name"
                                 keyValue="code"
                                 formControlName="listStatus"
                                 placeholder="{{'icn.icnContribution.calculate.search.status' | translate}}"
                                 labelText="{{'icn.icnContribution.calculate.search.status' | translate}}"
          ></hbt-select-check-able>
        </div>
        <div nz-col [nzXs]="24" [nzLg]="24" style="text-align: center">
          <hbt-button
            class="staff__research__btn__search"
            buttonAvailableStyle="SEARCH"
            buttonText="{{'common.button.search' | translate}}"
            (click)="search()"
          ></hbt-button>
        </div>

      </div>
    </div>
  </div>
  <div class='search__content--group' [ngClass]="{'search__content--group-hidden-header': isShowAdvSearch}">
    <hbt-table-wrap>
      <hbt-table
        (changePageNum)="search($event)"
        [tableConfig]="tableConfig" [dataList]="tableData"></hbt-table>
    </hbt-table-wrap>
  </div>
</form>

<ng-template #footerTmpl>
  <hbt-button
    buttonAvailableStyle="CANCEL"
    buttonText="{{ 'common.button.cancel' | translate }}"
    (click)="modalRef.destroy()">
  </hbt-button>
  <hbt-button
    buttonAvailableStyle="SAVE"
    buttonText="{{ 'common.button.saveS' | translate }}"
    (click)="modalRef.getContentComponent().save()">
  </hbt-button>
</ng-template>

<ng-template #actionTmpl let-data="data">
  <btn-more-action [model]="[data]" [setting]="actionSchema">
  </btn-more-action>
</ng-template>

<ng-template #employeeCodeTmpl let-data="data">
  <a (click)='showEmployeeInfos(data.employeeId)'>{{ data.employeeCode }}</a>
</ng-template>

<ng-template #employeeNameTmpl let-data="data">
  <a (click)='showEmployeeInfos(data.employeeId)'>{{ data.fullName }}</a>
</ng-template>

<ng-template #footerCancelTmpl>
  <hbt-button
    buttonAvailableStyle="CANCEL"
    buttonText="{{ 'common.button.cancel' | translate }}"
    (click)="modalRef.destroy()">
  </hbt-button>
</ng-template>
