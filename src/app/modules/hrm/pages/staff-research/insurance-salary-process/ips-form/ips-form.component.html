<form nz-form [formGroup]="form">
  <div nz-row [nzGutter]='[20,15]'>
    <!--id nhân viên-->
    <div nz-col [nzXs]="12" [nzLg]="12" *ngIf="!hiddenEmp">
      <employee-data-picker [isExpand]="true"
                            [functionCode]="functionCode"
                            [scope]="scope"
                            [status]='mode !== modeConst.ADD ? "ALL" : "ACTIVE"'
                            [formMode]="mode"
                            formControlName="employeeId"
                            [disable]="mode !== modeConst.ADD"
                            [type]="isSubmitted && form.controls['employeeId'].errors ? 'error' : 'default'"
                            [showError]="isSubmitted && form.controls['employeeId'].errors != null"
                            [errors]="form.controls['employeeId'].errors"
                            [errorDefs]="[{ errorName: 'required', errorDescription: 'common.validate.required' | translate: {'param': 'common.label.employeeName' | translate }}]"
                            labelText="{{'hrm.staffManager.insuranceSalaryProcess.table.employeeId' | translate}} <span class='label__required'>*</span>"
      >
      </employee-data-picker>
    </div>

    <!--Từ ngày-->
    <div nz-col [nzXs]="12" [nzLg]="12">
      <hbt-date-picker
        placeholderText="{{'hrm.staffManager.insuranceSalaryProcess.table.startDate' | translate}}"
        labelText="{{'hrm.staffManager.insuranceSalaryProcess.table.startDate' | translate}} <span class='label__required'>*</span>"
        [type]="isSubmitted && (form.errors || form.controls['startDate'].errors) ? 'error' : 'default'"
        [showError]="isSubmitted && (form.errors || form.controls['startDate'].errors ) != null"
        [errors]="form.errors?.rangeDateError ? form.errors : form.controls['startDate'].errors"
        [errorDefs]="[
           { errorName: 'required', errorDescription: 'common.validate.required' | translate: {'param': 'hrm.staffManager.insuranceSalaryProcess.table.startDate' | translate }}
        ]"
        formControlName="startDate"
        (ngModelChange)="changeStartDate($event)"
      ></hbt-date-picker>
    </div>

    <!-- Đối tượng -->
    <!-- <div nz-col [nzXs]="12" [nzLg]="12" *ngIf="listEmpType.length > 0">
      <hbt-select
        [dataSelects]="listEmpType"
        keyLabel="name"
        keyValue="empTypeId"
        formControlName="empTypeId"
        [type]="isSubmitted && form.controls['empTypeId'].errors ? 'error' : 'default'"
        [showError]="isSubmitted && form.controls['empTypeId'].errors != null"
        [errors]="form.controls['empTypeId'].errors"
        [errorDefs]="[{ errorName: 'required', errorDescription: 'common.validate.required' | translate: {'param': 'hrm.staffManager.insuranceSalaryProcess.table.empType' | translate }}]"
        placeholder="{{'hrm.staffManager.insuranceSalaryProcess.table.empType' | translate}}"
        labelText="{{'hrm.staffManager.insuranceSalaryProcess.table.empType' | translate}} <span class='label__required'>*</span>"
        (ngModelChange)="changeEmpType($event)"
      ></hbt-select>
    </div> -->

    <ng-container >
      <!--id ngạch lương-->
      <div nz-col [nzXs]="12" [nzLg]="12">
        <hbt-select
          [disable]="isDisableSalaryRank"
          [dataSelects]="listSalaryRank"
          keyLabel="displayName"
          keyValue="salaryRankId"
          formControlName="salaryRankId"
          [type]="isSubmitted && form.controls['salaryRankId'].errors ? 'error' : 'default'"
          [showError]="isSubmitted && form.controls['salaryRankId'].errors != null"
          [errors]="form.controls['salaryRankId'].errors"
          [errorDefs]="[{ errorName: 'required', errorDescription: 'common.validate.required' | translate: {'param': 'hrm.staffManager.insuranceSalaryProcess.table.jobSalaryId' | translate }}]"
          placeholder="{{'hrm.staffManager.insuranceSalaryProcess.table.jobSalaryId' | translate}}"
          labelText="{{'hrm.staffManager.insuranceSalaryProcess.table.jobSalaryId' | translate}} <span class='label__required'>*</span>"
        ></hbt-select>
      </div>

      <!--id bậc lương-->
      <div nz-col [nzXs]="12" [nzLg]="12" *ngIf="isShowSalaryGrade">
        <hbt-select
          [dataSelects]="listSalaryGrades"
          keyLabel="name"
          keyValue="salaryGradeId"
          formControlName="salaryGradeId"
          [type]="isSubmitted && form.controls['salaryGradeId'].errors ? 'error' : 'default'"
          [showError]="isSubmitted && form.controls['salaryGradeId'].errors != null"
          [errors]="form.controls['salaryGradeId'].errors"
          [errorDefs]="[{ errorName: 'required', errorDescription: 'common.validate.required' | translate: {'param': 'hrm.staffManager.insuranceSalaryProcess.table.salaryGradeId' | translate }}]"
          placeholder="{{'hrm.staffManager.insuranceSalaryProcess.table.salaryGradeId' | translate}}"
          labelText="{{'hrm.staffManager.insuranceSalaryProcess.table.salaryGradeId' | translate}} <span class='label__required'>*</span>"
          (eventEmit)="changeSalaryGrade($event)"
        ></hbt-select>
      </div>

      <!--Hệ số-->
      <div nz-col [nzXs]="12" [nzLg]="12" *ngIf="isShowSalaryGrade">
        <hbt-input-text
          [disable]="true"
          formControlName="factor"
          [type]="isSubmitted && form.controls['factor'].errors ? 'error' : 'default'"
          [showError]="isSubmitted && form.controls['factor'].errors != null"
          [errors]="form.controls['factor'].errors"
          [errorDefs]="[{ errorName: 'required', errorDescription: 'common.validate.required' | translate: {'param': 'hrm.staffManager.insuranceSalaryProcess.table.factor' | translate }}]"
          placeholderText="{{'hrm.staffManager.insuranceSalaryProcess.table.factor' | translate}}"
          labelText="{{'hrm.staffManager.insuranceSalaryProcess.table.factor' | translate}}"
        ></hbt-input-text>
      </div>

      <!--Tỷ lệ hưởng-->
      <div nz-col [nzXs]="12" [nzLg]="12" *ngIf="isShowSalaryGrade">
        <hbt-select
          [urlLoadData]="getUrlCategory(categoryCode.HR_TY_LE_HUONG_LUONG)"
          keyLabel="name"
          keyValue="name"
          formControlName="percent"
          [type]="isSubmitted && form.controls['percent'].errors ? 'error' : 'default'"
          [showError]="isSubmitted && form.controls['percent'].errors != null"
          [errors]="form.controls['percent'].errors"
          [errorDefs]="[{ errorName: 'required', errorDescription: 'common.validate.required' | translate: {'param': 'hrm.staffManager.insuranceSalaryProcess.table.percent' | translate }}]"
          placeholder="{{'hrm.staffManager.insuranceSalaryProcess.table.percent' | translate}}"
          labelText="{{'hrm.staffManager.insuranceSalaryProcess.table.percent' | translate}} <span class='label__required'>*</span>"
        ></hbt-select>
      </div>

      <!--hệ số chênh lệch bảo lưu-->
      <div nz-col [nzXs]="12" [nzLg]="12" *ngIf="isShowSalaryGrade">
        <hbt-input-text
          formControlName="reserveFactor"
          appNumberic
          maxLength="5"
          [num]="2"
          [decimals]="2"
          [type]="isSubmitted && form.controls['reserveFactor'].errors ? 'error' : 'default'"
          [showError]="isSubmitted && form.controls['reserveFactor'].errors != null"
          [errors]="form.controls['reserveFactor'].errors"
          [errorDefs]="[{ errorName: 'maxlength', errorDescription: 'common.validate.maxLength' | translate: {'numberLength': 4}}]"
          placeholderText="{{'hrm.staffManager.insuranceSalaryProcess.table.reserveFactor' | translate}}"
          labelText="{{'hrm.staffManager.insuranceSalaryProcess.table.reserveFactor' | translate}}"
        ></hbt-input-text>
      </div>

      <!--  Mốc xét nâng bậc -->
      <div nz-col [nzXs]="12" [nzLg]="12" *ngIf="isShowSalaryGrade">
        <hbt-date-picker
          placeholderText="{{'hrm.staffManager.insuranceSalaryProcess.table.incrementDate' | translate}}"
          labelText="{{'hrm.staffManager.insuranceSalaryProcess.table.incrementDate' | translate}}"
          [type]="isSubmitted && (form.errors || form.controls['incrementDate'].errors) ? 'error' : 'default'"
          [showError]="isSubmitted && (form.errors || form.controls['incrementDate'].errors ) != null"
          [errors]="form.errors?.rangeDateError ? form.errors : form.controls['incrementDate'].errors"
          [errorDefs]="[
             { errorName: 'required', errorDescription: 'common.validate.required' | translate: {'param': 'hrm.staffManager.insuranceSalaryProcess.table.incrementDate' | translate }}
          ]"
          formControlName="incrementDate"></hbt-date-picker>
      </div>
    </ng-container>
    
      <!--   Mức hưởng   -->
      <div nz-col [nzXs]="12" [nzLg]="12" *ngIf="!isShowSalaryGrade">
        <hbt-input-text
          [isFormatterCurrency]="true"
          [integerPart]="14"
          [decimalPart]="2"
          [inputType]="'number'"
          [showFlexEnd]="false"
          formControlName="amount"
          [type]="isSubmitted && form.controls['amount'].errors ? 'error' : 'default'"
          [showError]="isSubmitted && form.controls['amount'].errors != null"
          [errors]="form.controls['amount'].errors"
          [errorDefs]="[
             { errorName: 'required', errorDescription: 'common.validate.required' | translate: {'param': 'hrm.staffManager.insuranceSalaryProcess.table.amount' | translate }}
          ]"
          placeholderText="{{'hrm.staffManager.insuranceSalaryProcess.table.amount' | translate}}"
          labelText="{{'hrm.staffManager.insuranceSalaryProcess.table.amount' | translate}} <span class='label__required'>*</span>"
        ></hbt-input-text>
      </div>

    <!--số quyết định-->
    <div nz-col [nzXs]="12" [nzLg]="12">
      <hbt-input-text
        formControlName="documentNo" maxLength="50"
        [type]="isSubmitted && form.controls['documentNo'].errors ? 'error' : 'default'"
        [showError]="isSubmitted && form.controls['documentNo'].errors != null"
        [errors]="form.controls['documentNo'].errors"
        [errorDefs]="[{ errorName: 'maxlength', errorDescription: 'common.validate.maxLength' | translate: {'numberLength': 50}}]"
        placeholderText="{{'hrm.staffManager.insuranceSalaryProcess.table.documentNo' | translate}}"
        labelText="{{'hrm.staffManager.insuranceSalaryProcess.table.documentNo' | translate}}"
      ></hbt-input-text>
    </div>

    <!--ngày ký quyết định-->
    <div nz-col [nzXs]="12" [nzLg]="12">
      <hbt-date-picker
        placeholderText="{{'hrm.staffManager.insuranceSalaryProcess.table.documentSignedDate' | translate}}"
        labelText="{{'hrm.staffManager.insuranceSalaryProcess.table.documentSignedDate' | translate}}"
        formControlName="documentSignedDate"></hbt-date-picker>
    </div>

    <ng-container formArrayName="listAttributes">
      <ng-container *ngFor="let attributes of attributesFormArray.controls; let idx = index" [formGroupName]="idx">
        <div nz-col [nzXs]="12" [nzLg]="12">
          <input-attribute-common
            [controlName]="getAttributeControl(idx, 'attributeValue')"
            [dataType]="attributes.get('dataType')?.value"
            [urlLoadData]="attributes.get('urlLoadData')?.value"
            [type]="isSubmitted && attributes.get('attributeValue')?.errors ? 'error' : 'default'"
            [showError]="isSubmitted && attributes.get('attributeValue')?.errors != null"
            [errors]="attributes.get('attributeValue')?.errors"
            [errorDefs]="[{ errorName: 'required', errorDescription: 'common.validate.required' | translate: {'param': attributes.get('attributeName')?.value | translate }}]"
            [placeholderText]="attributes.get('attributeName')?.value"
            [labelText]="getLabelText(attributes.get('attributeName')?.value, attributes.get('isRequired')?.value)"
          >
          </input-attribute-common>
        </div>
      </ng-container>
    </ng-container>

    <!-- File đính kèm -->
    <div nz-col [nzXs]='24' [nzLg]='24' class="input__group">
      <hbt-upload
        [fileList]="f['files'].value"
        [(docIdsDelete)]="docIdsDelete"
        [typeFileAvailable]="['jpeg', 'jpg', 'png', 'pdf', 'doc', 'docx']"
        [multiple]="true"
        labelText="{{'common.label.attachFile' | translate}}"
        (fileListChange)="onFileListChange($event, 'files', true)"
        (docIdsDeleteChange)="removeFile($event, 'files')"
        [serviceName]='microService.HRM'
        [showError]="isSubmitted"
        [maxSize]="3"
        [disable]="mode === modeConst.VIEW"
      ></hbt-upload>
    </div>
  </div>
</form>

